<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /

  # 1. Ausnahme: API-Aufrufe direkt durchlassen
  RewriteRule ^api/ - [L]

  # 2. Spezialfall: Absolute Hauptdomain auf /app/ umleiten
  # Das muss VOR der Pr체fung auf existierende Verzeichnisse stehen!
  RewriteRule ^$ /app/ [R=301,L]

  # 3. Wenn die angeforderte DATEI existiert (js, css, bilder), direkt ausliefern
  # WICHTIG: Die Pr체fung auf Verzeichnisse (-d) haben wir hier entfernt,
  # damit /app nicht als Ordner erkannt wird und abbricht.
  RewriteCond %{REQUEST_FILENAME} -f
  RewriteRule ^ - [L]

  # 4. Wenn der Pfad NICHT mit /app anf채ngt, /app/ davorh채ngen (z.B. /login)
  RewriteCond %{REQUEST_URI} !^/app($|/)
  RewriteRule ^(.*)$ /app/$1 [R=301,L]

  # 5. Vue.js History Mode:
  # Alle Aufrufe, die jetzt mit /app beginnen, laden die index.html
  RewriteRule ^app($|/) index.html [L]
</IfModule>
